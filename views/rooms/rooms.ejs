<% if (title) { %>
  <h1><%= title %></h1>
  <% } else {
    res.redirect('/')
  } %>

<%- messages() %>

<% if (errors) { %>
<ul class="notice">
<% errors.array().forEach(error => { %>
 <li><%= error.msg %></li>
<%  }) %>
</ul>
<% } %>

        
<div id="formContainer" class="formContainer">
    <form id="updateForm" class="form" action="/emp/edit_employee" method="POST">

        <fieldset>
          <label for="departmentList">Department:</label>
          <%- departmentList %>          
        
          <label for="emp_fname">First Name:</label>
          <input type="text" name="emp_fname" id="emp_fname" placeholder="Min of two characters"
          required value="<%= locals.emp_fname %>">

          <label for="emp_mname">Middle Name:</label>
          <input type="text" name="emp_mname" id="emp_mname" placeholder="Min of two characters"
          required value="<%= locals.emp_mname %>">

          <label for="emp_lname">Last Name:</label>
          <input type="text" name="emp_lname" id="emp_lname" placeholder="Min of two characters"
          required value="<%= locals.emp_lname %>">

          <label for="emp_bdate">Birth Date:</label>
          <input type="text" name="emp_bdate" id="emp_bdate"
          required value="<%= locals.emp_bdate %>">
          
          <label for="emp_hdate">Hire Date:</label>
          <input type="text" name="emp_hdate" id="emp_hdate"
          required value="<%= locals.emp_hdate %>">

          <label for="emp_image">Image Path:</label>
          <input type="text" name="emp_image" id="emp_image" 
          required value="<%= locals.emp_image%>">

          <label for="emp_thumbnail">Thumbnail Path:</label>
          <input type="text" name="emp_thumbnail" id="emp_thumbnail" 
          required value="<%= locals.emp_thumbnail %>">

          <label for="emp_pnumber">Phone Number:</label>
          <input type="text" name="emp_pnumber" id="emp_pnumber" placeholder="111 111 1111"
          required value="<%= locals.emp_pnumber %>">

          <input type="hidden" name="emp_id"
          <% if(locals.emp_id) { %> value="<%= locals.emp_id %>"
          <% } %>>
          
        <button type="submit" disabled>Update Employee</button>
        </fieldset>
    </form>
</div>

<script src="/js/update.js"> </script>

<script>
  function formatDateToMMDDYYYY(dateStr) {
      let date = new Date(dateStr);
      let month = ("0" + (date.getMonth() + 1)).slice(-2);
      let day = ("0" + date.getDate()).slice(-2);
      let year = date.getFullYear();
      return `${month}-${day}-${year}`;
  }

  let birthDateStr = "Mon Jan 30 1995 00:00:00 GMT-0300 (hora estándar de Argentina)";
  let hireDateStr = "Mon Jul 01 2024 00:00:00 GMT-0300 (hora estándar de Argentina)";

  let formattedBirthDate = formatDateToMMDDYYYY(birthDateStr);
  let formattedHireDate = formatDateToMMDDYYYY(hireDateStr);

  document.getElementById('emp_bdate').value = formattedBirthDate;
  document.getElementById('emp_hdate').value = formattedHireDate;
</script>